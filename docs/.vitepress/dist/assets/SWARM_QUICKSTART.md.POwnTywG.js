import{_ as a,c as i,o as e,a2 as n}from"./chunks/framework.BUjRcKcJ.js";const c=JSON.parse('{"title":"üêù Swarm Quickstart (Single Storage Host + Future Workers)","description":"","frontmatter":{},"headers":[],"relativePath":"SWARM_QUICKSTART.md","filePath":"SWARM_QUICKSTART.md","lastUpdated":1765392164000}'),t={name:"SWARM_QUICKSTART.md"};function l(r,s,h,p,d,o){return e(),i("div",null,s[0]||(s[0]=[n(`<h1 id="üêù-swarm-quickstart-single-storage-host-future-workers" tabindex="-1">üêù Swarm Quickstart (Single Storage Host + Future Workers) <a class="header-anchor" href="#üêù-swarm-quickstart-single-storage-host-future-workers" aria-label="Permalink to &quot;üêù Swarm Quickstart (Single Storage Host + Future Workers)&quot;">‚Äã</a></h1><p>Goal: run the media stack on your storage box today, keep the path clear to add Raspberry Pi/other nodes later.</p><h2 id="_0-prereqs" tabindex="-1">0) Prereqs <a class="header-anchor" href="#_0-prereqs" aria-label="Permalink to &quot;0) Prereqs&quot;">‚Äã</a></h2><ul><li>Real Docker Engine (not Podman) with <code>docker compose</code> v2.</li><li>SELinux: ensure your media/config paths are labeled (<code>chcon -Rt svirt_sandbox_file_t /home/deck/usenet</code>), or temporarily set permissive while testing.</li></ul><h2 id="_1-configure" tabindex="-1">1) Configure <a class="header-anchor" href="#_1-configure" aria-label="Permalink to &quot;1) Configure&quot;">‚Äã</a></h2><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> .env.example</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> .env</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Edit .env to set TZ/DOMAIN and adjust CONFIG_ROOT/DOWNLOADS_ROOT/MEDIA_ROOT paths</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Create the bind directories:</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mkdir</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /home/deck/usenet/{config,downloads,media}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="_2-init-swarm-label-the-storage-node" tabindex="-1">2) Init swarm &amp; label the storage node <a class="header-anchor" href="#_2-init-swarm-label-the-storage-node" aria-label="Permalink to &quot;2) Init swarm &amp; label the storage node&quot;">‚Äã</a></h2><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> swarm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> init</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> node</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> update</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --label-add</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> storage=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --label-add</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> performance=high</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">hostname</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Optional: create traefik public overlay if you use the traefik labels</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> network</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> create</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --driver</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> overlay</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --attachable</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> traefik-public</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="_3-deploy-using-local-bind-overrides" tabindex="-1">3) Deploy using local bind overrides <a class="header-anchor" href="#_3-deploy-using-local-bind-overrides" aria-label="Permalink to &quot;3) Deploy using local bind overrides&quot;">‚Äã</a></h2><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">STACK</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">\${STACK_NAME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">usenet}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> stack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> deploy</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> docker-compose.swarm.yml</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> docker-compose.swarm.local-bind.yml</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $STACK</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>The base file keeps overlay networking; the override swaps NFS volumes for host bind mounts so the stack works on a single storage node.</p><h2 id="_4-add-workers-later" tabindex="-1">4) Add workers later <a class="header-anchor" href="#_4-add-workers-later" aria-label="Permalink to &quot;4) Add workers later&quot;">‚Äã</a></h2><ul><li>Join: <code>docker swarm join --token &lt;token&gt; &lt;manager-ip&gt;</code></li><li>Label Pis as <code>performance=low</code> (they‚Äôll be avoided for heavy services). For services that must run on Pis, add/update placement constraints.</li><li>If you want multi-node shared storage, export your media/config as NFS and switch back to the base file only (remove the local-bind override) or provide an NFS-capable override.</li></ul><h2 id="_5-update-rollback" tabindex="-1">5) Update/rollback <a class="header-anchor" href="#_5-update-rollback" aria-label="Permalink to &quot;5) Update/rollback&quot;">‚Äã</a></h2><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> stack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ls</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> stack</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ps</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $STACK</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> service</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> logs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $STACK_sabnzbd </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">--tail</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 50</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="notes" tabindex="-1">Notes <a class="header-anchor" href="#notes" aria-label="Permalink to &quot;Notes&quot;">‚Äã</a></h2><ul><li>Traefik labels expect an external overlay <code>traefik-public</code>; create it even if you don‚Äôt run Traefik yet to avoid missing-network errors.</li><li>PUID/PGID default to 1000; set in <code>.env</code> if your host differs.</li><li>The override keeps all services constrained to <code>storage=true</code> where volumes are needed (prowlarr now included).</li></ul>`,19)]))}const u=a(t,[["render",l]]);export{c as __pageData,u as default};
