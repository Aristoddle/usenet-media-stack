import{_ as o,c as a,o as t,a2 as i}from"./chunks/framework.BUjRcKcJ.js";const m=JSON.parse('{"title":"Operations Runbook (Bazzite host)","description":"","frontmatter":{},"headers":[],"relativePath":"ops-runbook.md","filePath":"ops-runbook.md","lastUpdated":1766050220000}'),c={name:"ops-runbook.md"};function s(r,e,l,d,n,u){return t(),a("div",null,e[0]||(e[0]=[i('<h1 id="operations-runbook-bazzite-host" tabindex="-1">Operations Runbook (Bazzite host) <a class="header-anchor" href="#operations-runbook-bazzite-host" aria-label="Permalink to &quot;Operations Runbook (Bazzite host)&quot;">​</a></h1><h2 id="daily-quick-checks" tabindex="-1">Daily/quick checks <a class="header-anchor" href="#daily-quick-checks" aria-label="Permalink to &quot;Daily/quick checks&quot;">​</a></h2><ul><li><code>docker ps</code> to confirm containers are up.</li><li>Komga up: <code>curl -I http://localhost:8081</code>.</li><li>Komf up: <code>curl -I http://localhost:8085</code>.</li><li>Comics mount: ensure <code>${COMICS_ROOT}</code> is present and writable (example: <code>/var/mnt/fast8tb/Cloud/OneDrive/Books/Comics</code>).</li></ul><h2 id="reboot-checklist" tabindex="-1">Reboot checklist <a class="header-anchor" href="#reboot-checklist" aria-label="Permalink to &quot;Reboot checklist&quot;">​</a></h2><ol><li>Reboot to apply staged rpm-ostree layer (Docker).</li><li>Enable Docker daemon: <code>sudo systemctl enable --now docker</code>.</li><li>Add user to docker group: <code>sudo usermod -aG docker $USER &amp;&amp; newgrp docker</code>.</li><li>Start stacks: <ul><li>Comics: <code>docker compose -f docker-compose.komga.yml up -d</code></li><li>Reading stack: <code>docker compose -f docker-compose.reading.yml up -d</code></li><li>Main: <code>docker compose up -d</code></li></ul></li></ol><h2 id="healthchecks-to-keep-restore" tabindex="-1">Healthchecks to keep/restore <a class="header-anchor" href="#healthchecks-to-keep-restore" aria-label="Permalink to &quot;Healthchecks to keep/restore&quot;">​</a></h2><ul><li>Bazarr, Overseerr, Plex, Tdarr, Prowlarr: http healthchecks (<code>curl -f http://localhost:&lt;port&gt;</code> with 30s interval, 10s timeout, 3 retries) in compose.</li><li>Service constraints: keep storage/performance labels where used (Swarm).</li></ul><h2 id="storage-paths-host" tabindex="-1">Storage &amp; paths (host) <a class="header-anchor" href="#storage-paths-host" aria-label="Permalink to &quot;Storage &amp; paths (host)&quot;">​</a></h2><ul><li>Media root: <code>${MEDIA_ROOT}</code> (example: <code>/var/mnt/fast8tb/Local/media</code>)</li><li>Books root: <code>${BOOKS_ROOT}</code> (example: <code>/var/mnt/fast8tb/Cloud/OneDrive/Books</code>)</li><li>Comics: <code>${COMICS_ROOT}</code></li><li>Ebooks: <code>${EBOOKS_ROOT}</code></li><li>Audiobooks: <code>${AUDIOBOOKS_ROOT}</code></li><li>Configs: <code>${CONFIG_ROOT}</code> (plus <code>${AUDIOBOOKSHELF_CONFIG}</code> and <code>${KOMETA_CONFIG}</code> if used)</li><li>OneDrive comics source (GVFS): <code>/run/user/1000/gvfs/onedrive:host=gmail.com,user=J3lanzone/Bundles_b896e2bb7ca3447691823a44c4ad6ad7/Books/Comics/</code></li></ul><h2 id="secrets-env" tabindex="-1">Secrets &amp; env <a class="header-anchor" href="#secrets-env" aria-label="Permalink to &quot;Secrets &amp; env&quot;">​</a></h2><ul><li><code>.env</code> (gitignored): Prowlarr/NZB/Usenet provider keys.</li><li><code>.env</code>: <code>PLEX_CLAIM</code> for first-time Plex setup.</li><li>Kometa: <code>${KOMETA_CONFIG}/config.yml</code> (Plex token/URL).</li><li>Audiobookshelf config lives under its <code>*Config</code> dir on the OneDrive-backed disk.</li></ul><h2 id="plex-clients" tabindex="-1">Plex clients <a class="header-anchor" href="#plex-clients" aria-label="Permalink to &quot;Plex clients&quot;">​</a></h2><ul><li><strong>Plexamp</strong> for audio/music listening.</li><li><strong>Plex HTPC</strong> for TVs/HTPC setups; Smart TV apps for living room devices.</li></ul><h2 id="sops" tabindex="-1">SOPs <a class="header-anchor" href="#sops" aria-label="Permalink to &quot;SOPs&quot;">​</a></h2><ul><li>Restart a single service (Docker): <code>docker compose restart &lt;service&gt;</code>.</li><li>Tail logs (Docker): <code>docker compose logs -f &lt;service&gt;</code>; (Podman): <code>podman logs -f &lt;container&gt;</code>.</li><li>Re-run comics sync manually: use the systemd-run command in <code>docs/advanced/hot-swap.md</code>; avoid reboots while it runs.</li><li>Nightly comics sync: after current rsync completes, enable the <code>rsync-comics.timer</code> (see Daily/quick checks above).</li><li>Backup configs: tar or restic/borg the <code>*Config</code> directories (they’re already on OneDrive for versioning).</li></ul><h2 id="subtitles-metadata" tabindex="-1">Subtitles &amp; metadata <a class="header-anchor" href="#subtitles-metadata" aria-label="Permalink to &quot;Subtitles &amp; metadata&quot;">​</a></h2><ul><li>Bazarr: connect to Sonarr/Radarr, set subtitle languages/providers, enable post-processing.</li><li>Kometa (optional): only if Plex is enabled; config at <code>${KOMETA_CONFIG}/config.yml</code>.</li><li>Indexers: prefer Prowlarr as the single indexer manager; use Jackett only if an indexer is unsupported.</li></ul><h2 id="incident-shortcuts" tabindex="-1">Incident shortcuts <a class="header-anchor" href="#incident-shortcuts" aria-label="Permalink to &quot;Incident shortcuts&quot;">​</a></h2><ul><li>Port check: <code>ss -tlnp | grep 8081</code> (Komga), <code>5000</code> (Kavita), <code>13378</code> (Audiobookshelf), main stack ports as usual.</li><li>Disk space: <code>df -h ${MEDIA_ROOT}</code> (example: <code>/var/mnt/fast8tb/Local/media</code>).</li><li>GPU check (after Docker reboot): <code>docker run --rm --gpus all nvidia/cuda:12.4.1-base-ubuntu22.04 nvidia-smi</code> (if NVIDIA present).</li><li>Prowlarr indexer warnings: if health shows DNS/IPv6 issues, set service <code>dns: [1.1.1.1, 1.0.0.1]</code> and disable IPv6 via sysctls in compose, then recreate the container.</li></ul>',19)]))}const p=o(c,[["render",s]]);export{m as __pageData,p as default};
